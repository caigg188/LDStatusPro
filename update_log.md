### v3.1.1 更新内容 🔧 细节优化

**代码改进：**
- ⚡ **排行榜更新规则动态化** - 排行榜统计周期不再写死，而是从 `CONFIG.CACHE` 配置动态读取
  - 日榜: 每 5 分钟更新 (对应 `LEADERBOARD_DAILY_TTL`)
  - 周榜: 每 60 分钟更新 (对应 `LEADERBOARD_WEEKLY_TTL`)
  - 月榜: 每 3 小时更新 (对应 `LEADERBOARD_MONTHLY_TTL`)
- 🎯 修改配置即可自动更新显示文案，无需同步修改多处代码

**用户信息区域确认：**
- 头像（带悬停"查看"提示）
- 昵称 (displayName) + @用户名 (username)
- 信任等级 (Lv X)
- 升级要求进度 (X/Y 完成)

---
### v3.1.0 更新内容 ☁️ 升级要求数据云同步

**新增功能：**
- ☁️ **升级要求历史云同步** - 支持升级要求数据的跨设备同步
  - 自动上传本地升级要求历史到云端
  - 新设备登录时自动下载云端数据
  - 数据合并策略：取各字段的较大值，防止数据丢失
  - **权限要求**: 仅 `trust_level >= 2` 用户可用

**UI/UX 改进：**
- 🎨 **头像悬停提示** - 头像悬停时显示"查看"tooltip
- 👤 **用户名显示优化** - 登录后正确显示昵称而非仅用户名

**问题修复：**
- 🔧 修复 `_bindLoginPrompt()` 中按钮禁用状态设置错误的问题
- 🔧 修复 `oauth.getUser()` 方法不存在的调用错误
- 🔧 修复登录后界面未正确更新用户信息的问题

**后端更新 (v3.2.0)：**
- 新增 `requirements_history` 数据表
- 新增 `/api/requirements/sync` - 同步单日升级要求
- 新增 `/api/requirements/sync-full` - 上传完整历史
- 新增 `/api/requirements/history` - 获取历史数据

---
### v3.0.4 更新内容 🐛 Bug修复与体验优化

**问题修复：**
- 🔧 **低信任等级用户体验修复** - 修复 trust_level < 2 用户无法正常使用的问题
  - 修复 "Cannot read properties of undefined (reading '$')" 错误
  - 登录后正确显示用户信息（头像、昵称、等级）
  - 不再卡在"加载中"状态
- 🔧 **事件绑定修复** - 修复排行榜登录/加入按钮点击后被禁用的问题
  - 使用箭头函数替代 `.bind(this)` 避免 this 指向错误
  - 按钮状态正确更新

**交互优化：**
- 🎨 **头像交互增强** - 头像悬停时显示缩放和发光效果

**代码改进：**
- ✨ 新增 `_updateUserInfoFromOAuth()` 方法，从 OAuth 数据更新用户界面
- ⚡ 页面加载时自动显示已登录用户信息

---
### v3.0.3 更新内容 🎨 体验优化与功能增强

**排行榜优化：**
- 🎨 **用户显示样式升级** - 排行榜现在显示 name + @username 组合
  - 有昵称时：粗体昵称 + 浅色小号用户名
  - 无昵称时：保持原有粗体用户名样式
- 🔄 **手动刷新功能** - 排行榜统计周期旁新增刷新按钮
  - 支持手动获取最新排行榜数据
  - 5分钟冷却时间，各榜独立计算
  - 刷新时显示旋转动画和状态提示

**缓存策略优化：**
- ⏱️ **前端缓存时间调整**
  - 日榜：5分钟（与服务器更新频率匹配）
  - 周榜：60分钟
  - 月榜：3小时

**版本更新提醒：**
- 🎉 **智能更新气泡** - 发现新版本时显示醒目的气泡提示
  - 显示当前版本 → 新版本对比
  - 一键点击立即更新
  - 关闭后同版本不再重复提示
  - 检查按钮有更新时显示脉冲动画

**趋势显示修复：**
- 📊 本月/本年趋势数据显示条件优化（1条记录即可显示）

**信任等级兼容：**
- 🔐 **信任等级 < 2 支持** - 现在低信任等级用户也能使用阅读时间追踪功能
  - 无法获取升级要求时显示友好提示
  - 阅读追踪功能正常运行

**代码优化：**
- 🚀 重构排行榜事件绑定逻辑，消除重复代码
- ⚡ 使用 onclick 替代重复的 addEventListener，避免内存泄漏

---
### v3.0.1 更新内容 🚀 架构升级 - 存储迁移至 D1
**重大更新：**
- 🗄️ **存储后端迁移** - 从 Cloudflare KV 迁移到 D1 SQL 数据库
  - 写入限额从 1,000/天 提升到 100,000/天（**100 倍提升**）
  - 读取限额从 100,000/天 提升到 5,000,000/天（50 倍提升）
  - 存储空间从 1GB 提升到 5GB（5 倍提升）
  - 支持约 10,000-20,000 日活用户，原先仅支持 100-200 人

**技术改进：**
- 新增 `D1Database` 工具类封装所有数据库操作
- 排行榜计算使用 SQL 聚合查询，性能大幅提升
- 数据完全无损迁移，用户无感知升级
- 保留 KV 绑定用于迁移期间兼容

**迁移指南：**
1. 部署新版本后端
2. 通过 `/api/admin/migrate` 执行数据迁移
3. 验证数据完整性后移除 KV 引用

---
### v3.0.0 更新内容 🎉 重大更新 - 排行榜功能上线

**新增功能:**
- 🏆 **排行榜系统** - 全新的排行榜功能，与其他用户一较高下
  - 支持日榜、周榜、月榜三个时间维度
  - 展示前 50 名用户的阅读时间排名
  - 金银铜牌前三名特殊展示效果
- 🔐 **OAuth 登录** - 使用 Linux.do 账号安全授权
- 🛡️ **隐私优先** - 用户自主选择是否加入排行榜，随时可退出
- 👤 **我的排名** - 查看自己在各榜单中的位置
- 📡 **数据同步** - 阅读时间自动同步到云端排行榜

**技术实现:**
- 新增 `OAuthManager` 类处理 OAuth2 认证流程
- 新增 `LeaderboardManager` 类管理排行榜数据
- 新增排行榜 Tab UI 和相关样式
- 后端使用 Cloudflare Workers + KV 存储 (见 `backend/` 目录)

**其他:**
- 版本号升级到 3.0.0
- 更新 README 文档

---
### v3.0.1 更新内容 🔧 修复与性能优化
**修复与改进：**
- 修复 OAuth 登录后用户名未同步到本地 storage 的问题（导致云同步无法正确读取/写入用户数据）
- 修复云端下载超时问题：将后端 KV 读取从串行改为并行，并批处理以提升性能
- 优化 `getFullHistory` 接口，使用 KV list 获取用户全部阅读记录，避免时区或缺失数据问题
- 添加手动同步按钮（顶部 ☁️），支持完整的下载+上传流程
- 同步过程中按钮显示加载状态并禁用点击，防止重复触发
- 优化客户端缓存策略，日榜客户端缓存改为 5 分钟，服务器端 Cron 改为每 10 分钟计算
- 修复其他小 bug 与 UX 改进

**其他:**
- 版本号升级到 3.0.1
- 更新 README 与 DOCS 文档说明

---
### v2.8.7更新内容
- 现在缩小后的悬浮图标也支持拖动啦，展开和收缩动画优化。
- 修复明暗主题切换可能出现的UI闪烁问题。
- 增量统计部分的显示和数据调整。
- 一些动画优化和调整。